<div class="settings">
  <style>
    /* ===== Scoped layout only for Settings tab ===== */
    .settings { display:grid; gap:12px; max-width:100%; }
    .settings .section { display:grid; gap:10px; max-width:100%; }
    .settings .grid-auto { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:8px; }
    .settings .row { display:flex; gap:8px; flex-wrap:wrap; }

    /* Section titles */
    .settings .title { font-size:.875rem; opacity:.9 }

    /* Icon buttons */
    .settings .icon-btn{
      width:36px; height:36px; border-radius:10px;
      display:inline-flex; align-items:center; justify-content:center;
      background:#1f2937; border:1px solid #374151; color:#e5e7eb;
      cursor:pointer; padding:0;
    }
    .settings .icon-btn:hover{ filter:brightness(1.08); }
    .settings .icon-btn .ic{ width:18px; height:18px; display:block; }
    .settings .icon-btn.danger{ background:#3b1f20; border-color:#5b3032; color:#fca5a5; }

    /* Status pill (email / last synced) */
    .settings .status{
      display:flex; align-items:center; gap:8px; flex-wrap:wrap;
      background:linear-gradient(180deg,rgba(34,211,238,.08),rgba(34,211,238,.02));
      border:1px solid rgba(34,211,238,.45);
      box-shadow:0 6px 28px rgba(34,211,238,.12);
      padding:10px 12px; border-radius:12px;
    }
    .settings .status .email{ font-weight:600; }
    .settings .status .dot{ width:8px; height:8px; border-radius:999px; background:#34d399; display:inline-block; }
    .settings .status .dot.off{ background:#9ca3af; }

    /* Inputs / prevent overflow */
    .settings .card,.settings .input,.settings textarea.input{ max-width:100%; width:100%; }
    .settings .input,.settings textarea.input{ word-break:break-word; overflow-wrap:anywhere; }
    .settings .card{ overflow:hidden; }
    .settings pre{ white-space:pre-wrap; }

    details summary{ cursor:pointer; user-select:none; }
  </style>

  <!-- AUTH STATUS -->
  <div class="section">
    <div class="status">
      <span class="dot" id="authDot"></span>
      <span id="authStatus" class="email">Not signed in</span>
      <span class="text-xs text-sub">• Last synced:</span>
      <span id="lastSync" class="text-xs">—</span>
    </div>
  </div>

  <!-- GROUP 1: Google Auth & Cloud Sync -->
  <div class="section">
    <div class="title">Authentication & Cloud Sync</div>
    <div class="row">
      <!-- Login -->
      <button id="login" class="icon-btn" title="Sign in with Google" aria-label="Sign in with Google">
        <!-- Google G -->
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M21.35 11.1h-9.18v2.98h5.45c-.24 1.5-1.64 4.4-5.45 4.4-3.28 0-5.95-2.7-5.95-6.02s2.67-6.02 5.95-6.02c1.87 0 3.12.8 3.84 1.5l2.62-2.52C17.68 3.3 15.77 2.5 13.62 2.5 8.94 2.5 5.2 6.24 5.2 10.92s3.74 8.42 8.42 8.42c4.86 0 8.08-3.41 8.08-8.22 0-.55-.06-1.02-.15-1.5z"/></svg>
      </button>
      <!-- Logout -->
      <button id="logout" class="icon-btn danger" title="Logout" aria-label="Logout">
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M14.08,15.59L16.67,13H7V11H16.67L14.08,8.41L15.5,7L20.5,12L15.5,17L14.08,15.59M5,3H12V5H5V19H12V21H5C3.89,21 3,20.1 3,19V5C3,3.9 3.89,3 5,3Z"/></svg>
      </button>
      <!-- Pull -->
      <button id="pull" class="icon-btn" title="Pull settings from cloud" aria-label="Pull from cloud">
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M19 18H6a4 4 0 0 1 0-8c.46 0 .9.08 1.31.21A5.994 5.994 0 0 1 18 8a6 6 0 0 1 1 11.9V18zM11 12v4h2v-4h3l-4-4-4 4h3z"/></svg>
      </button>
      <!-- Push -->
      <button id="push" class="icon-btn" title="Push settings to cloud" aria-label="Push to cloud">
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M19 18H6a4 4 0 1 1 0-8c.46 0 .9.08 1.31.21A5.994 5.994 0 0 1 18 8c2.76 0 5 2.24 5 5a5 5 0 0 1-4 4.9V18zM13 12V8h-2v4H8l4 4 4-4h-3z"/></svg>
      </button>
    </div>
  </div>

  <!-- GROUP 2: Settings Management -->
  <div class="section">
    <div class="title">Settings Management</div>
    <div class="row">
      <!-- Save -->
      <button id="save" class="icon-btn" title="Save settings" aria-label="Save settings">
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M17 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14V7l-2-4zm-5 16a3 3 0 1 1 .001-6.001A3 3 0 0 1 12 19zm3-10H5V5h10v4z"/></svg>
      </button>
      <!-- Reset -->
      <button id="reset" class="icon-btn danger" title="Reset to defaults" aria-label="Reset to defaults">
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M12,5V1L7,6l5,5V7c3.31,0 6,2.69 6,6c0,1.01 -0.25,1.97 -0.69,2.8l1.46,1.46C19.57,16.06 20,14.58 20,13c0,-4.42 -3.58,-8 -8,-8zm-6.77,1.73L3.77,8.19C2.61,9.68 2,11.52 2,13c0,4.42 3.58,8 8,8v4l5,-5l-5,-5v4c-3.31,0 -6,-2.69 -6,-6c0,-1.01 0.25,-1.97 0.69,-2.8z"/></svg>
      </button>
      <!-- Export -->
      <button id="export" class="icon-btn" title="Export settings" aria-label="Export settings">
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M5 20h14v-2H5v2zm7-18l-5 5h3v4h4V7h3l-5-5z"/></svg>
      </button>
      <!-- Import (from clipboard) -->
      <button id="import" class="icon-btn" title="Import settings (from clipboard)" aria-label="Import settings">
        <svg class="ic" viewBox="0 0 24 24" fill="currentColor"><path d="M19 20H5v-2h14M14 10V4h-4v6H5l7 7 7-7h-5z"/></svg>
      </button>
    </div>
  </div>

  <hr/>

  <!-- SUPABASE (collapsed) -->
  <details id="sec-supabase">
    <summary class="text-sm">Supabase Settings</summary>
    <div class="section">
      <div class="grid-auto">
        <input id="sup-url" class="input" placeholder="Supabase URL (e.g., https://xyz.supabase.co)" />
        <input id="sup-key" class="input" placeholder="Supabase anonKey" />
        <input id="sup-schema" class="input" placeholder="Schema (default: public)" />
        <input id="sup-table" class="input" placeholder="Settings table (dvtool_settings)" />
        <input id="sup-redirect" class="input" placeholder="Redirect URL" disabled />
        <input id="sup-project" class="input" placeholder="Project ID (optional)" />
      </div>
    </div>
  </details>

  <!-- GEMINI (collapsed) -->
  <details id="sec-gemini">
    <summary class="text-sm">Gemini Settings</summary>
    <div class="section">
      <div class="grid-auto">
        <input id="gm-base" class="input" placeholder="API Base (e.g., https://generativelanguage.googleapis.com)" />
        <input id="gm-key" class="input" placeholder="API Key" />
        <input id="gm-model" class="input" placeholder="Model (e.g., gemini-1.5-pro)" />
      </div>
    </div>
  </details>

  <!-- FEATURE FLAGS -->
  <div class="section">
    <div class="title">Feature Flags</div>
    <div class="row">
      <label class="flex gap-2 items-center"><input id="ff-tele" type="checkbox"> <span>Enable telemetry</span></label>
      <label class="flex gap-2 items-center"><input id="ff-dry" type="checkbox"> <span>Dry-run cleaner</span></label>
    </div>
  </div>
</div>
